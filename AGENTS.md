# Repository Guidelines

## Project Structure & Module Organization
- Core CLI: `bin/` (entry: `bin/setup.js`)
- Library code: `lib/` (pure, testable modules like `lib/language-detector.js`)
- Scripts: `scripts/` (maintenance/migration utilities)
- Tests: `__tests__/` (Jest; fixtures and helpers included)
- Templates: `templates/` (provider/language rules copied into projects)
- Assets/Reports: `resources/`, `coverage/` (generated by tests)

## Build, Test, and Development Commands
- `npm test` — run Jest test suite.
- `npm run test:watch` — watch mode for local development.
- `npm run test:coverage` — generate coverage (HTML in `coverage/`).
- `npm run migrate` — migrate projects to centralized `.dev/rules/` layout.
- Local CLI: `node bin/setup.js` (e.g., `node bin/setup.js --help`).

## Coding Style & Naming Conventions
- JavaScript (Node 16.14+ or 18+), CommonJS `require/module.exports`.
- Indentation: 2 spaces; prefer small, pure functions with dependency injection for IO.
- Filenames: kebab-case for files (`language-detector.js`), directories singular where appropriate.
- Avoid side effects in `lib/`; isolate process/filesystem work to `bin/` and `scripts/`.

## Testing Guidelines
- Framework: Jest (`jest.config.js`).
- Location: tests in `__tests__/`; name tests `*.test.js`.
- Coverage thresholds (global): 70% lines/branches/functions/statements. Ensure `npm run test:coverage` passes.
- Use fixtures in `__tests__/fixtures/` and helpers in `__tests__/helpers/`.

## Commit & Pull Request Guidelines
- Keep commits focused and descriptive (present tense). Reference issues when relevant.
- Update `CHANGELOG.md` for notable user-facing changes (Keep a Changelog + SemVer).
- PRs must include: clear summary, rationale, test coverage evidence, and any migration notes.
- Screenshots/log snippets welcome for CLI UX changes.

## Security & Configuration Tips
- Base rules are managed copies in `.dev/rules/`; avoid editing them directly. Use `.dev/rules/.local/` for overrides.
- Do not commit generated `coverage/` or local project artifacts.
- Respect user environments: never overwrite existing configs without backups (pattern used across scripts).

## Agent-Specific Notes
- If adding templates, keep `.dev/rules/` as the single source of truth; providers reference it.
- New providers/languages should mirror existing template structure and testing approach.
